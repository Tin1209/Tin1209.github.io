---
title: 20210305TIL 
categories: 
- TIL
tags: 
- TIL
---

# 오늘 한 일 
-----
<br/> 

### 알고리즘 문제해결 전략 
- 8.13까지 끝내기로 한지 벌써 이틀이 지났는데 아직 끝내지 못했다... 심지어 백준 문제도 하나도 안풀었다. 다음주부터 딥러닝 스터디를 시작해서 현재 하고있는 딥러닝 공부를 빨리 끝내야한다는 압박감 떼문인지 요즘 알고리즘 공부에 소홀해지는것 같다. 다음주부터는 다시 열심히 하자! 


### 파이토치 첫걸음  
- 이번에는 스타일 트랜스퍼와 오토 인코더를 공부했다. 스타일 트랜스퍼 모델을 구현할 때 자꾸 에러가 나서 곤란한 상황이 많이 발생했는데, 알고보니 목표하는 이미지를 만드는 모델을 학습시키기 위해 새로운 모델을 만들어줘야 하는데, 새로 모델을 선언해주지 않고 이전에 전이 학습을 할 때 쓴 모델을 그대로 다시 써서 발생한 에러였다. 
- 오늘은 오토인코더를 공부했는데, 이 내용 또한 노션에 정리해뒀으므로 여기에 길게 적지는 않겠다. 오토인코더 기본 모델을 구현하는데 코랩에서 MNIST 데이터셋을 받아오지 못하는 오류가 계속 발생해서 결국 코랩을 떠나 주피터로 옮겨가기로 마음먹었다. 아직 실습이 부족한 부분이 있다. 오늘 주피터 초기 세팅을 하느라 공부는 거의 못한것 같다. 

### 주피터 세팅 
- 오늘 가장 많은 시간을 쏟아부은 부분이다. 처음에는 그냥 노트북에서 모든걸 해결하려고 했지만, 엔비디아에서 mac os는 더이상 지원하지 않아 GPU 사용이 불가능하다는 점 때문에 윈도우 데스크탑에 원격으로 연결하기로했다. 어차피 노트북 그래픽이 내장이라 원래 불가능하기도 했지만.. 그렇게 윈도우 데스크탑에서 먼저 아나콘다를 통해 가상환경을 만들어주고, 그 가상환경에 파이토치도 깔고, 여러 필요한 모듈들을 다운받았다. 
- 그런 다음 주피터 커널에 아나콘다에서 만든 가상환경을 추가해주었더니 처음에는 잘 되는 듯 싶었다. 욕심이 생겨서 여기서 GPU도 쓸 수 있게끔 세팅을 해보자! 라는 마음으로 잘못된 길을 들어섰다. 
- 우선 엔비디아에서 그래픽 드라이버를 받았다. 그래픽 드라이버를 받은 후 CUDATOOLKIT을 받았다. 내 CUDATOOLKIT의 버전은 10.0 이었다. 나는 여기서 끝인 줄 알고 원격 접속을 허용하려고 다시 열심히 검색을 했다. 예전에 sql을 원격으로 허용하는 것과는 달리 주피터는 원격 접속이 훨씬 쉬웠다. 그냥 이런 설정이 그때는 처음이었고 지금은 몇 번 해봐서 쉽게 느껴지는 것일수도 있다.. 아무튼 ipython에서 먼저 패스워드를 설정해주고, ssh 형식으로 패스워드가 변환되어 결과가 출력되는데, 그것을 복사해서 주피터의 설정 파일인 jupyter-config(파일 이름이 정확한지는 잘 모르겠다..)에서 원격 접속 관련 설정을 해주면 되는 것이었다. 
- 파이썬 파일로 되어있길래 처음에 파이참으로 열려고 했다가 수정만 하면 될거 굳이 무거운 프로그램을 쓰지 않아도 되겠다 싶어서 메모장으로 열어주었다. 이것도 처음 알았는데 맥북은 vim을 따로 설치한 기억이 없는데 터미널에서 바로 실행이 되고, 윈도우는 vim을 홈페이지에서 따로 받아야하더라.. 아무튼 메모장으로 열어서 먼저 c.NotebookApp.ip를 수정해주었다. 대부분의 코드가 주석처리 되어있었다. 주석을 해제하고 localhost로 되어있는 부분을 *로 바꿔주었다. localhost는 host와 같은 ip를 공유하는 기기만 접속을 허용하는 것인데, 이것을 모든 아이피를 허용하는 *로 바꿔준다. 다음은 c.NotebookApp.passward 였다. 이것도 마찬가지로 주석처리가 되어있었고 기본값은 없었다. 그런데 블로그에서 그 값을 'sha1:SHA_VALUE' 로 바꾸라고 해서 저게 무엇인지 알아내느라 또 한참을 헤맸다. 내가 복사한 것은 ssh라고 했는데 저기에 넣는게 맞는건가? 하는 의심을 품고 맨 처음에는 아까 복사한 ssh를 붙여넣었다. 그런데 비밀번호가 제대로 설정이 되지 않아서 이것이 아님을 깨닫고 먼저 설정한 비밀번호를 문자 그대로 넣었다. 이것도 아니었다. 알고보니 ssh 값을 넣을때 양 끝에 작은 따옴표를 하나씩 더 붙여서 넣은게 문제였다. 따옴표를 제거하고 붙여넣어줬더니 설정이 잘 되었다. 두 가지 설정이 더 있었는데, 하나는 주피터에 접속할 때 비밀번호를 요구할 것인지를 설정하는 것이었고, 나머지 하나는 포트 번호를 설정하는 것이었다. 이 설정을 마치고 나서 방화벽에서 내가 설정한 포트에 대한 원격 접속을 허용만 해주면 원격 접속에 대한 세팅은 끝이다! 
- 이렇게 세팅을 열심히 하고 나서 파이토치를 다시 깔아야 한다는 것을 깨달았다. 여기서 내가 아나콘다 가상환경인 pytorch의 모듈을 바꾸면 주피터에 pytorch로 추가한 커널의 특성도 바뀔까? 라는 생각이 들었다. 그래서 주피터의 커널 폴더를 찾아 들어가보니, 정말 너무나도 구조가 간단했다. 파이썬 로고가 들어가있는 로고 파일 두개와, json 파일 하나였다. json 파일을 열어서 확인해보니 내 아나콘다 디렉토리에 있는 pytorch 가상환경 안의 python 파일을 실행시키는 것 같았다. 이것을 보고 굳이 주피터의 커널을 업데이트 해주지 않아도 pytorch 가상환경을 바꿔주면 커널의 특성도 똑같이 바뀌는것을 깨달았다. 
- 처음에는 아까 설치한 파이토치가 아까워서 지우지 않고 그 위에 그대로 cuda의 버전에 맞는 파이토치를 다시 깔았다. 덮어씌워진건지 어떻게 된건지는 잘 모르겠지만, 그렇게 깔고 보니 제대로 돌아가지를 않았다. 이때까지만해도 import torch는 잘 됐었는데 cuda가 사용 불가능한 것으로 나왔다. 그래서 그냥 설치되어있던 파이토치들을 전부 지우고 cuda 버전에 맞는 파이토치를 다시 깔았다. 내가 다운받은 버전은 pytorch==1.2.0, torchvision==0.4.0 이었다. 이렇게 다운받고 코드를 돌려보니 이번에는 import torch부터 에러가 났다... 에러 문구를 읽어보니 numpy 모듈을 불러오는데에서 오류가 난 것이었다! 난 당최 이해가 가질 않았다. numpy는 내가 알기로는 분명 기본 라이브러리인데 대체 왜 오류가 나는거지? 열심히 구글링을 해보니 numpy의 버전이 내가 다운받은 pytorch와 버전이 안맞아서 나는 오류라고 한다. 그런데 conda uninstall numpy를 하려하니 파이토치까지 같이 지워진다는 것이었다! 그때 생각은 그러면 파이토치를 깔 때 numpy도 같이 깔린걸까? 였다. 그런데 지금 생각해보면 버전도 맞지않는 numpy를 파이토치와 묶어서 다운하지는 않을것 같다.. 그래서 가상환경을 아예 싹 다 갈아엎기로 했다. 파이썬도 3.7 버전에서 3.6 버전으로 낮추고, 다시 파이토치를 깔았다. 그랬더니 또!!! 똑같은 오류가 났다. 그러다 다른 블로그에서 단순히 conda install numpy로 numpy를 다운받는게 아니라, conda install  -c conda-forge numpy 라는 명령어로 numpy를 먼저 받아주었다. 위의 명령어와 정확히 뭐가 다른지는 잘 모르겠지만, 저렇게 먼저 numpy를 받아주고 이제 cuda 버전과 맞는 파이토치를 다운받아주니 드디어 모든 모듈이 제대로 임포트되었다!! 정말 멀리 돌고돌아 그래도 결국에는 윈도우 데스크탑에 GPU를 사용할 수 있게끔 세팅까지 하고 원격 접속까지 설정을 완료했다! 이것보다는 도커를 사용하는게 더 편하다는 얘기를 들어서 조만간 도커도 사용을 해 볼 생각이다! 



<br/><br/><br/><br/><br/><br/>

# 내일 할 일 
-----
<br/>

### 파이토치 첫걸음 
- GAN 이론 정리, 실습  

### cs231n 1강 듣기 